/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   champions.c                                        :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: mbartole <marvin@42.fr>                    +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2019/11/23 18:31:34 by mbartole          #+#    #+#             */
/*   Updated: 2019/11/28 18:32:21 by mbartole         ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

# include "corewar.h"

void	get_champion(char *file, t_champ *champ, int i, t_cbox *cbox)
{
	champ->id = i;
	// TODO read evrth from champion file, validate and set properties of champ[i]

	// moke up jumper.cor
	champ->code_size = 320;
	champ->name = "Jumper !";
	champ->comm = "en fait C forker !";
	if (!(champ->code = ft_memalloc(champ->code_size)))
		exit(clean_all(cbox, MALLOC_ERROR));
	char tab[320] = {0x33, 0x70, 0x1, 0, 0x49, 0x3, 0x70, 0x6, 255, 0xfc,
					 0x2, 0xd0, 0x00, 0x3f, 0x01, 0x02, 0x90, 0x00, 0x00, 0x00, 0x00, 0x07, 0x09, 0x00,
					 0x37, 0x01, 0x00, 0x00, 0x00, 0x42, 0x0a, 0x94, 0xff, 0xfb, 0x03, 0x01, 0x0b, 0x64,
					 0x01, 0xff, 0x53, 0x03, 0x04, 0x54, 0x03, 0x04, 0x03, 0x08, 0x54, 0x05, 0x03, 0x06,
					 0x09, 0x00, 0x0d, 0x02, 0x90, 0x00, 0x00, 0x00, 0x00, 0x07, 0x09, 0xff,
					 0xdb, 0x08, 0x54, 0x03, 0x03, 0x03, 0x09, 0xff, 0x31, 0x03, 0x50, 0x01, 0x01, 0x0b,
					 0x68, 0x01, 0x00, 0x07, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x42, 0x0b, 0x68, 0x02,
					 0xff, 0xb6, 0xff, 0xc4, 0x02, 0x90, 0x00, 0x00, 0x00, 0x04, 0x04, 0x03, 0x70, 0x02,
					 0x02, 0x00, 0x02, 0x90, 0x00, 0x00, 0x00, 0x30, 0x05, 0x0b, 0x68, 0x01, 0xff, 0xa6,
					 0x00, 0x01, 0x0b, 0x68, 0x01, 0x00, 0x96, 0x00,
					 0x01, 0x0b, 0x68, 0x01, 0x00, 0x23, 0x00, 0x01, 0x0b, 0x68, 0x01, 0x00, 0x21, 0x00,
					 0x01, 0x0b, 0x68, 0x01, 0x00, 0x1f, 0x00, 0x01, 0x0b, 0x68, 0x01, 0x00, 0x1d, 0x00,
					 0x01, 0x0b, 0x68, 0x01, 0x00, 0x1b, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x42, 0x01,
					 0x00, 0x00, 0x00, 0x42, 0x01, 0x00, 0x00, 0x00, 0x42, 0x01, 0x00, 0x00, 0x00, 0x42,
					 0x01, 0x00, 0x00, 0x00, 0x42, 0x09, 0xff, 0xe7,
					 0x08, 0x54, 0x03, 0x03, 0x03, 0x0b, 0x68, 0x01, 0x00, 0x07, 0x00, 0x01, 0x01, 0x00,
					 0x00, 0x00, 0x42, 0x0c, 0xff, 0xd3, 0x0b, 0x68, 0x01, 0x00, 0x1c, 0x00, 0x01, 0x0b,
					 0x68, 0x01, 0x00, 0x15, 0x00, 0x09, 0x0b, 0x68, 0x01, 0x00, 0x0e, 0x00, 0x11, 0x0b,
					 0x68, 0x01, 0x00, 0x07, 0x00, 0x19, 0x01, 0x00, 0x00, 0x00, 0x42, 0x0c, 0xff, 0x24,
					 0x01, 0x00, 0x00, 0x00, 0x42, 0x0c, 0xff, 0xf3,
					 0x01, 0x00, 0x00, 0x00, 0x42, 0x0c, 0x00, 0x0b, 0x01, 0x00, 0x00, 0x00, 0x42, 0x09,
					 0xff, 0x0c, 0x01, 0x00, 0x00, 0x00, 0x42, 0x0a, 0x94, 0xff, 0xfb, 0x03, 0x01, 0x0b,
					 0x64, 0x01, 0x00, 0x11, 0x03, 0x04, 0x54, 0x03, 0x04, 0x03, 0x08, 0x54, 0x05, 0x03,
					 0x06, 0x09, 0x00, 0x0d, 0x02, 0x90, 0x00, 0x00, 0x00, 0x00, 0x07, 0x09, 0xff, 0xdb,
					 0x08, 0x54, 0x03, 0x03, 0x03, 0x09, 0x00, 0x01};
	ft_memcpy(champ->code, tab, 320);
}

void	greet_champions(t_champ *champs, int size)
{
	int 	i;

	ft_printf("{YELLOW}Introducing contestants...\n");
	i = -1;
	while (++i < size)
		if (champs[i].id)
			ft_printf("* Player %i, weighing %i bytes, \"%s\" (\"%s\") !\n",
					  champs[i].id, champs[i].code_size,
					  champs[i].name, champs[i].comm);
}

void	greet_winner(t_arena *arena)
{
	t_champ *champ;

	champ = arena->last_alive;
	ft_printf("Player %d, \"%s\", has won !\n", champ->id, champ->name);
}
